using System;
using System.Collections.Generic;
using System.Linq;
using DataTier;  // Добавьте эту строку

namespace LogicTier
{
    public class СтроениеОбёртка
    {
        private Строение _строение;
        public СтроениеОбёртка(Строение building) => _строение = building;

        public string Тип => _строение.Тип;
        public int Комнат => _строение.Комнат;
        public double Метраж => _строение.Метраж;
        public decimal Стоимость => _строение.Стоимость;
        public decimal СтоимостьЗаКвадрат => _строение.Стоимость / (decimal)_строение.Метраж;
        public string Представление => $"{Тип}, {Комнат} ком., {Метраж} м², {Стоимость:C}";
    }

    public class АгентствоНедвижимости
    {
        private List<СтроениеОбёртка> _строения;
        public АгентствоНедвижимости()
        {           
            var данные = ВсеСтроения.ПолучитьВсеСтроения();
            _строения = данные.Select(b => new СтроениеОбёртка(b)).ToList();
        }

        public List<СтроениеОбёртка> СписокСтроений => _строения;
        public string НазваниеАгентства => "Агентство недвижимости";

        // Максимальная стоимость за квадратный метр
        public СтроениеОбёртка ОбъектСМаксСтоимостьюКвадрата =>
            _строения.OrderByDescending(b => b.СтоимостьЗаКвадрат).First();

        // Средняя стоимость квадратного метра для квартир
        public decimal СредняяСтоимостьКвадратаКвартир
        {
            get
            {
                var квартиры = _строения.Where(b => b.Тип == "Квартира");
                return квартиры.Average(b => b.СтоимостьЗаКвадрат);
            }
        }
    }
}
